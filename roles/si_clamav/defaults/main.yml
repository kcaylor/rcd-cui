---
# Enable or disable this role without changing playbook ordering.
si_clamav_enabled: true

# Package list required by this control implementation.
si_clamav_packages:
  - clamav
  - clamav-update

# Template files deployed by this role.
si_clamav_templates:
  - src: clamd.conf.j2
    dest: /etc/clamd.d/scan.conf
    owner: root
    group: root
    mode: "0644"
  - src: freshclam.conf.j2
    dest: /etc/freshclam.conf
    owner: root
    group: root
    mode: "0644"

# Static helper files deployed by this role.
si_clamav_files:
  []

# Services managed by this role.
si_clamav_services:
  - name: clamd@scan
    enabled: true
    state: started
  - name: freshclam
    enabled: true
    state: started

# Read-only verification commands for compliance checks.
si_clamav_verify_commands:
  - id: clamd_active
    command: "systemctl is-active clamd@scan"
  - id: clamd_conf
    command: "test -f /etc/clamd.d/scan.conf"

# File paths captured as evidence artifacts.
si_clamav_evidence_files:
  - /etc/clamd.d/scan.conf
  - /etc/freshclam.conf

# Read-only commands captured as evidence artifacts.
si_clamav_evidence_commands:
  - id: freshclam_status
    command: "systemctl status freshclam --no-pager"
