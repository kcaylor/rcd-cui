---
# Enable or disable this role without changing playbook ordering.
ia_ssh_ca_enabled: true

# Package list required by this control implementation.
ia_ssh_ca_packages:
  - openssh-server

# Template files deployed by this role.
ia_ssh_ca_templates:
  - src: sshd_config_ca.j2
    dest: /etc/ssh/sshd_config.d/40-cui-ca.conf
    owner: root
    group: root
    mode: "0644"

# Static helper files deployed by this role.
ia_ssh_ca_files:
  []

# Services managed by this role.
ia_ssh_ca_services:
  - name: sshd
    enabled: true
    state: started

# Read-only verification commands for compliance checks.
ia_ssh_ca_verify_commands:
  - id: ssh_ca_conf
    command: "test -f /etc/ssh/sshd_config.d/40-cui-ca.conf"
  - id: sshd_check
    command: "sshd -T"

# File paths captured as evidence artifacts.
ia_ssh_ca_evidence_files:
  - /etc/ssh/sshd_config.d/40-cui-ca.conf

# Read-only commands captured as evidence artifacts.
ia_ssh_ca_evidence_commands:
  - id: trusted_ca
    command: "grep -E '^TrustedUserCAKeys' /etc/ssh/sshd_config.d/40-cui-ca.conf || true"

ia_ssh_ca_public_key_path: "/etc/ssh/trusted-user-ca-keys.pem"
